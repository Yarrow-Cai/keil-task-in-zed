# keil-task-in-zed

# Zed-Keil-集成编译环境 使用说明

## 简介

本工具集旨在将 Keil C51/MDK-ARM 的编译、烧录和清理功能无缝集成到 Zed 编辑器中，让你无需离开 Zed 即可完成嵌入式项目的主要操作。

它通过 Zed 的“任务(Tasks)”功能调用批处理脚本，实现了项目文件的自动查找和命令的自动执行。

---

## 快速开始

### 步骤 1: 一次性配置 Keil 路径

这是 **最重要** 的一步，只需设置一次。

1.  用文本编辑器打开 `.zed` 文件夹中的 `keil_task.bat` 文件。
2.  找到文件顶部的这一行：
    ```batch
    SET KEIL_PATH=D:\Program Files\ARM\MDK5\UV4\UV4.exe
    ```
3.  将等号 `=` 后面的路径替换为你自己电脑上 Keil 的 `UV4.exe` 或 `UV5.exe` 的 **真实、完整** 的安装路径。

### 步骤 2: 在你的项目中使用

1.  将整个 `.zed` 文件夹复制到你 **任何一个** Keil 工程的根目录下。
2.  用 Zed 编辑器打开这个工程文件夹。

### 步骤 3: 运行任务

1.  在 Zed 中，按下快捷键 `Ctrl + Shift + P` 打开命令面板。
2.  输入 `Tasks: Run` 并回车，此时会显示出所有可用的任务。
3.  选择你想要执行的任务：
    *   `Keil: 编译 (自动查找)`: 增量编译你的项目。
    *   `Keil: 重新编译 (自动查找)`: 完全重新编译你的项目。
    *   `Keil: 烧录 (自动查找)`: 编译并烧录程序到目标硬件。
    *   `Keil: 清理 (Clean)`: 清理编译过程中产生的临时文件。

---

## 原理简介

*   `.zed/tasks.json`: Zed 任务的定义文件。它告诉 Zed 命令面板中有哪些任务，以及每个任务应该执行什么命令。
*   `.zed/keil_task.bat`: 核心功能脚本。它会自动查找项目中的 `.uvprojx` 或 `.uvproj` 文件，并根据任务传来的参数（`build`, `flash` 等）调用 Keil 执行相应操作，同时捕获并显示 Keil 的原生输出。
*   `.zed/keilkilll.bat`: 一个简单的清理脚本，用于删除 Keil 编译产生的各种中间文件。

---

## 常见问题解答

**问：任务执行失败，输出 `[ERROR] Keil 程序未在 "..." 找到`？**

**答：** 这是最常见的问题。请回到 **[步骤 1](#步骤-1-一次性配置-keil-路径)**，仔细检查并确保你在 `keil_task.bat` 文件中设置的 `KEIL_PATH` 路径是完全正确的。
